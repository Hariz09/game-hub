import type { GameCard } from "@/types/medieval"

const baseCards: Omit<GameCard, "id">[] = [
  // Nobility Cards
  {
    name: "King Arthur",
    type: "nobility",
    rarity: "legendary",
    strength: 8,
    cost: 6,
    loyalty: 5,
    ability: "Rally all units (+1 strength each)",
    abilityType: "rally",
  },
  {
    name: "Queen Guinevere",
    type: "nobility",
    rarity: "epic",
    strength: 6,
    cost: 5,
    loyalty: 4,
    ability: "Heal 3 HP when played",
    abilityType: "heal",
  },
  {
    name: "Duke of Lancaster",
    type: "nobility",
    rarity: "rare",
    strength: 5,
    cost: 4,
    loyalty: 3,
    ability: "Grant 2 shield to all allies",
    abilityType: "shield",
  },
  {
    name: "Earl of Warwick",
    type: "nobility",
    rarity: "rare",
    strength: 4,
    cost: 3,
    loyalty: 2,
    ability: "Boost all units (+1 strength)",
    abilityType: "boost",
  },
  {
    name: "Baron of York",
    type: "nobility",
    rarity: "common",
    strength: 3,
    cost: 2,
    loyalty: 2,
    ability: "Gain +1 resource per turn",
    abilityType: "resource_gain",
  },
  {
    name: "Prince of Wales",
    type: "nobility",
    rarity: "epic",
    strength: 5,
    cost: 4,
    loyalty: 3,
    ability: "Rally nearby units (+1 strength)",
    abilityType: "rally",
  },

  // Support Cards
  {
    name: "Royal Healer",
    type: "support",
    rarity: "epic",
    strength: 1,
    cost: 3,
    loyalty: 4,
    ability: "Heal 3 HP each turn",
    abilityType: "heal",
  },
  {
    name: "Court Wizard",
    type: "support",
    rarity: "epic",
    strength: 2,
    cost: 4,
    loyalty: 3,
    ability: "Boost all units (+2 strength)",
    abilityType: "boost",
  },
  {
    name: "Royal Guard",
    type: "support",
    rarity: "rare",
    strength: 2,
    cost: 2,
    loyalty: 3,
    ability: "Grant 3 shield",
    abilityType: "shield",
  },
  {
    name: "Battle Strategist",
    type: "support",
    rarity: "rare",
    strength: 1,
    cost: 2,
    loyalty: 2,
    ability: "Boost all units (+1 strength)",
    abilityType: "boost",
  },
  {
    name: "Castle Priest",
    type: "support",
    rarity: "common",
    strength: 1,
    cost: 2,
    loyalty: 3,
    ability: "Heal 2 HP each turn",
    abilityType: "heal",
  },
  {
    name: "Royal Treasurer",
    type: "support",
    rarity: "epic",
    strength: 1,
    cost: 3,
    loyalty: 4,
    ability: "Gain +2 resources per turn",
    abilityType: "resource_gain",
  },

  // Commoner Cards
  {
    name: "Knight Templar",
    type: "commoner",
    rarity: "epic",
    strength: 6,
    cost: 4,
    loyalty: 3,
    ability: "Grant 2 shield when played",
    abilityType: "shield",
  },
  {
    name: "Elite Archer",
    type: "commoner",
    rarity: "epic",
    strength: 5,
    cost: 3,
    loyalty: 2,
    ability: "Deal 5 direct damage",
    abilityType: "direct_damage",
  },
  {
    name: "Heavy Cavalry",
    type: "commoner",
    rarity: "rare",
    strength: 4,
    cost: 3,
    loyalty: 2,
    ability: "Boost self (+1 strength per turn)",
    abilityType: "boost",
  },
  {
    name: "Crossbow Squad",
    type: "commoner",
    rarity: "rare",
    strength: 3,
    cost: 2,
    loyalty: 2,
    ability: "Deal 3 direct damage",
    abilityType: "direct_damage",
  },
  {
    name: "Foot Soldier",
    type: "commoner",
    rarity: "common",
    strength: 2,
    cost: 1,
    loyalty: 1,
    ability: "Rally nearby units (+1 strength)",
    abilityType: "rally",
  },
  {
    name: "Militia",
    type: "commoner",
    rarity: "common",
    strength: 1,
    cost: 1,
    loyalty: 1,
    ability: "Grant 1 shield to self",
    abilityType: "shield",
  },
  {
    name: "Peasant Levy",
    type: "commoner",
    rarity: "common",
    strength: 1,
    cost: 0,
    loyalty: 1,
    ability: "Heal 1 HP when played",
    abilityType: "heal",
  },
  {
    name: "Village Blacksmith",
    type: "commoner",
    rarity: "common",
    strength: 2,
    cost: 2,
    loyalty: 2,
    ability: "Boost all weapons (+1 strength)",
    abilityType: "boost",
  },

  // Legendary Cards
  {
    name: "Merlin the Wise",
    type: "legendary",
    rarity: "legendary",
    strength: 4,
    cost: 7,
    loyalty: 6,
    ability: "Boost all units (+3 strength)",
    abilityType: "boost",
  },
  {
    name: "Lancelot du Lac",
    type: "legendary",
    rarity: "legendary",
    strength: 9,
    cost: 7,
    loyalty: 5,
    ability: "Rally all units (+2 strength each)",
    abilityType: "rally",
  },
  {
    name: "The Black Knight",
    type: "legendary",
    rarity: "legendary",
    strength: 7,
    cost: 6,
    loyalty: 4,
    ability: "Assassinate weakest enemy unit",
    abilityType: "assassinate",
  },
  {
    name: "Morgan le Fay",
    type: "legendary",
    rarity: "legendary",
    strength: 5,
    cost: 6,
    loyalty: 5,
    ability: "Heal 5 HP and grant 3 shield",
    abilityType: "heal",
  },

  // Additional variety cards
  {
    name: "Royal Merchant",
    type: "commoner",
    rarity: "common",
    strength: 1,
    cost: 2,
    loyalty: 2,
    ability: "Gain +1 resource per turn",
    abilityType: "resource_gain",
  },
  {
    name: "Court Assassin",
    type: "commoner",
    rarity: "epic",
    strength: 3,
    cost: 4,
    loyalty: 1,
    ability: "Assassinate target unit",
    abilityType: "assassinate",
  },
  {
    name: "Battle Cleric",
    type: "support",
    rarity: "epic",
    strength: 2,
    cost: 3,
    loyalty: 3,
    ability: "Heal 2 HP and grant 2 shield",
    abilityType: "heal",
  },
  {
    name: "Master Economist",
    type: "support",
    rarity: "legendary",
    strength: 2,
    cost: 5,
    loyalty: 4,
    ability: "Gain +3 resources per turn",
    abilityType: "resource_gain",
  },
  {
    name: "Siege Engineer",
    type: "commoner",
    rarity: "epic",
    strength: 3,
    cost: 3,
    loyalty: 2,
    ability: "Deal 4 direct damage to all enemies",
    abilityType: "direct_damage",
  },
  {
    name: "Royal Diplomat",
    type: "nobility",
    rarity: "epic",
    strength: 2,
    cost: 4,
    loyalty: 5,
    ability: "Gain +2 resources when played",
    abilityType: "resource_gain",
  },
  {
    name: "War Engineer",
    type: "commoner",
    rarity: "rare",
    strength: 4,
    cost: 4,
    loyalty: 2,
    ability: "Deal 3 direct damage",
    abilityType: "direct_damage",
  },
]

const grandTournamentCards: Omit<GameCard, "id">[] = [
  // 1 Legendary
  {
    name: "King Theron",
    type: "nobility",
    rarity: "legendary",
    strength: 10,
    cost: 8,
    loyalty: 6,
    ability: "Rally all units (+3 strength each)",
    abilityType: "rally",
  },

  // 2 Epic
  {
    name: "Lady Isolde",
    type: "legendary",
    rarity: "epic",
    strength: 8,
    cost: 7,
    loyalty: 5,
    ability: "Boost all units (+4 strength) and heal 3 HP",
    abilityType: "boost",
  },
  {
    name: "Sir Kael",
    type: "nobility",
    rarity: "epic",
    strength: 7,
    cost: 5,
    loyalty: 4,
    ability: "Grant 4 shield and boost self (+2 strength)",
    abilityType: "shield",
  },

  // 6 Rare
  {
    name: "Elara",
    type: "commoner",
    rarity: "rare",
    strength: 6,
    cost: 4,
    loyalty: 3,
    ability: "Deal 6 direct damage",
    abilityType: "direct_damage",
  },
  {
    name: "Gareth",
    type: "commoner",
    rarity: "rare",
    strength: 5,
    cost: 4,
    loyalty: 3,
    ability: "Deal 4 direct damage and boost self (+1 strength)",
    abilityType: "direct_damage",
  },
  {
    name: "Bronn",
    type: "commoner",
    rarity: "rare",
    strength: 6,
    cost: 3,
    loyalty: 2,
    ability: "Boost self (+2 strength per turn)",
    abilityType: "boost",
  },
  {
    name: "Lynette",
    type: "support",
    rarity: "rare",
    strength: 2,
    cost: 3,
    loyalty: 4,
    ability: "Grant 3 shield to all allies",
    abilityType: "shield",
  },
  {
    name: "Finnian",
    type: "support",
    rarity: "rare",
    strength: 1,
    cost: 2,
    loyalty: 3,
    ability: "Boost all units (+2 strength)",
    abilityType: "boost",
  },
  {
    name: "Marcus",
    type: "nobility",
    rarity: "rare",
    strength: 5,
    cost: 4,
    loyalty: 3,
    ability: "Rally nearby units (+2 strength)",
    abilityType: "rally",
  },

  // 11 Common
  {
    name: "City Guard",
    type: "commoner",
    rarity: "common",
    strength: 3,
    cost: 2,
    loyalty: 2,
    ability: "Grant 2 shield to self",
    abilityType: "shield",
  },
  {
    name: "Court Mage",
    type: "support",
    rarity: "common",
    strength: 1,
    cost: 2,
    loyalty: 3,
    ability: "Heal 2 HP when played",
    abilityType: "heal",
  },
  {
    name: "Arena Fighter",
    type: "commoner",
    rarity: "common",
    strength: 4,
    cost: 3,
    loyalty: 2,
    ability: "Boost self (+1 strength)",
    abilityType: "boost",
  },
  {
    name: "Tournament Scout",
    type: "commoner",
    rarity: "common",
    strength: 2,
    cost: 1,
    loyalty: 2,
    ability: "Deal 2 direct damage",
    abilityType: "direct_damage",
  },
  {
    name: "Royal Page",
    type: "support",
    rarity: "common",
    strength: 1,
    cost: 1,
    loyalty: 3,
    ability: "Heal 1 HP each turn",
    abilityType: "heal",
  },
  {
    name: "Squire",
    type: "commoner",
    rarity: "common",
    strength: 2,
    cost: 1,
    loyalty: 2,
    ability: "Grant 1 shield to self",
    abilityType: "shield",
  },
  {
    name: "Herald",
    type: "support",
    rarity: "common",
    strength: 1,
    cost: 2,
    loyalty: 3,
    ability: "Boost all units (+1 strength)",
    abilityType: "boost",
  },
  {
    name: "Stable Boy",
    type: "commoner",
    rarity: "common",
    strength: 1,
    cost: 1,
    loyalty: 1,
    ability: "Gain +1 resource when played",
    abilityType: "resource_gain",
  },
  {
    name: "Apprentice",
    type: "support",
    rarity: "common",
    strength: 1,
    cost: 1,
    loyalty: 2,
    ability: "Heal 1 HP when played",
    abilityType: "heal",
  },
  {
    name: "Guard Captain",
    type: "commoner",
    rarity: "common",
    strength: 3,
    cost: 2,
    loyalty: 2,
    ability: "Rally nearby units (+1 strength)",
    abilityType: "rally",
  },
  {
    name: "Merchant",
    type: "commoner",
    rarity: "common",
    strength: 1,
    cost: 2,
    loyalty: 2,
    ability: "Gain +1 resource per turn",
    abilityType: "resource_gain",
  },
]

export const ALL_CARDS = baseCards.map((card, index) => ({
  ...card,
  id: `card_${card.name.replace(/\s+/g, "_").toLowerCase()}_${index}`,
}))

export const GRAND_TOURNAMENT_CARDS = grandTournamentCards.map((card, index) => ({
  ...card,
  id: `gt_${card.name.replace(/\s+/g, "_").toLowerCase()}_${index}`,
}))

// Add all cards together
export const ALL_CARDS_WITH_BANNERS = [...ALL_CARDS, ...GRAND_TOURNAMENT_CARDS]

// Update the createDeckFromCards function to ensure unique cards
export const createDeckFromCards = (cards: GameCard[], playerId: string): GameCard[] => {
  // Remove duplicates by name and create unique IDs
  const uniqueCards = cards.filter((card, index, self) => index === self.findIndex((c) => c.name === card.name))

  return uniqueCards.map((card, index) => ({
    ...card,
    id: `${playerId}_${card.name.replace(/\s+/g, "_").toLowerCase()}_${index}`,
  }))
}

// Update STARTER_CARDS to remove duplicates
export const STARTER_CARDS = [
  ALL_CARDS.find((c) => c.name === "Foot Soldier")!,
  ALL_CARDS.find((c) => c.name === "Militia")!,
  ALL_CARDS.find((c) => c.name === "Peasant Levy")!,
  ALL_CARDS.find((c) => c.name === "Village Blacksmith")!,
  ALL_CARDS.find((c) => c.name === "Castle Priest")!,
  ALL_CARDS.find((c) => c.name === "Royal Guard")!,
  ALL_CARDS.find((c) => c.name === "Baron of York")!,
  ALL_CARDS.find((c) => c.name === "Heavy Cavalry")!,
  ALL_CARDS.find((c) => c.name === "Crossbow Squad")!,
  ALL_CARDS.find((c) => c.name === "Royal Merchant")!,
  ALL_CARDS.find((c) => c.name === "Battle Strategist")!,
  ALL_CARDS.find((c) => c.name === "Earl of Warwick")!,
  ALL_CARDS.find((c) => c.name === "Royal Healer")!,
  ALL_CARDS.find((c) => c.name === "Elite Archer")!,
  ALL_CARDS.find((c) => c.name === "Knight Templar")!,
]

export const createEnhancedDeck = (playerId: string): GameCard[] => {
  return createDeckFromCards(STARTER_CARDS, playerId)
}
